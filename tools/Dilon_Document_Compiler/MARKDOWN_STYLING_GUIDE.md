# Markdown Styling Guide for Dilon Documents

This guide defines the markdown formatting standards for technical documents that will be converted to Word format using the Dilon Document Compiler.

## Overview

Documents are written in **Pandoc-flavored Markdown** and converted to Word (`.docx`) using:
- **Pandoc** for markdown → Word conversion
- **python-docx** for template rendering and document assembly
- **Reference template** (`TEMPLATE_Word_Signature.docx`) for styling

---

## 1. YAML Front Matter

Every document **must** begin with YAML front matter enclosed in `---` delimiters:

```yaml
---
title: "Document Title"
author: "Author Name"
department: "Engineering"
doc_number: "DD_XXX_XXXXX"
current_revision: "1"
regulatory_rep: "Regulatory Representative"
quality_rep: "Quality Representative"
department_head: "Department Head"
revisions:
  - number: "1"
    description: "Initial release"
    eco_number: "--"
    eco_date: "--"
---
```

**Required Fields:**
- `title`: Full document title
- `author`: Primary author or team
- `department`: Usually "Engineering"
- `doc_number`: Dilon document number (format: `DD_XXX_XXXXX`)
- `current_revision`: Current revision number (string)
- `regulatory_rep`, `quality_rep`, `department_head`: Approver names
- `revisions`: Array of revision history entries

**Troubleshooting Gray Blocks:**
If you see gray highlighted blocks in the generated Word document, there are two possible causes:

**Cause 1: Unresolved Jinja2 Variable**
1. Check that all variables in the Word template (e.g., `{{variable_name}}`) have corresponding entries in the YAML front matter
2. Open `TEMPLATE_Word_Signature.docx` and search for `{{` to find all template variables
3. Ensure every template variable has a value in your markdown's YAML front matter
4. Common culprits: missing author, department, or approver names

**Cause 2: Legacy Word Form Fields**
If the gray block appears without any `{{variable}}` nearby, it's likely a Word form field:
1. Open `TEMPLATE_Word_Signature.docx` in Word
2. Enable "Developer" tab: File → Options → Customize Ribbon → Check "Developer"
3. Click "Design Mode" button in Developer tab to see form fields
4. Click the gray form field and press Delete
5. Turn off "Design Mode"
6. Save the template
7. **Note**: Form fields often appear after text like "Electronic" in signature tables

**Revision Entry Format:**
```yaml
- number: "1.1"
  description: "Updated Section 3.5 with new calibration data"
  eco_number: "ECO-2025-042"
  eco_date: "2025-10-15"
```

---

## 2. Headings

Use ATX-style headings with `##` for sections:

```markdown
## 1. Section Title

### 1.1 Subsection Title

#### 1.1.1 Sub-subsection Title
```

**Rules:**
- **Main sections**: `## N. Section Name` (two hashes, numbered)
- **Subsections**: `### N.M Subsection Name` (three hashes, numbered)
- **Sub-subsections**: `#### N.M.P Sub-subsection Name` (four hashes, numbered)
- **Always use a space** after the hashes
- **Number sections manually** in markdown (e.g., `## 3. Device Specifications`)
- **Always include a blank line after each heading** before starting content (paragraphs, lists, tables, etc.)
- Table of Contents is auto-generated by Pandoc

**Example:**
```markdown
## 2. I2C Bus Architecture

### 2.1 Bus Topology

The I2C bus connects the nRF52832 to eleven peripheral devices.

### 2.2 Address Map

Each device has a unique 7-bit I2C address.
```

---

## 3. Tables

### 3.1 Format: Pipe Tables (Recommended)

Use **pipe tables** for all tabular data. This format is readable in markdown and converts cleanly to Word.

**Syntax:**
```markdown
| Column 1 | Column 2 | Column 3 |
|----------|----------|----------|
| Data 1A  | Data 2A  | Data 3A  |
| Data 1B  | Data 2B  | Data 3B  |
```

**Column Alignment:**
- **Left-aligned** (default): `|----------|`
- **Right-aligned**: `|---------:|`
- **Center-aligned**: `|:--------:|`

**Example:**
```markdown
| Address | Device | Function | Priority |
|---------|--------|----------|----------|
| 0x19 | LIS331 | Accelerometer | Medium |
| 0x24 | NCD9830 | ADC | High |
| 0x36 | MAX17263 | Fuel Gauge | High |
```

**With Alignment:**
```markdown
| Address | Device | Voltage (V) | Description |
|:--------|:-------|------------:|-------------|
| 0x19    | LIS331 | 3.3         | Accelerometer |
| 0x24    | NCD9830| 3.3         | 8-Channel ADC |
```

### 3.2 Table Formatting in Word Output

**Grid Lines:**
- Grid lines and borders are controlled by the **Word reference template** (`TEMPLATE_Word_Signature.docx`)
- **IMPORTANT**: "Table Grid" is a reserved Word built-in style that cannot be modified
- Two custom table styles are available:
  - **DilonTable_List**: For tables with a header row only (most common)
  - **DilonTable_Chart**: For tables with both header row AND header column (data intersection tables)
- **Do not** manually add grid lines in markdown
- Pandoc will apply table styles from the reference document to converted tables

**Table Style Descriptions:**

**DilonTable_List** (Default for most tables):
- Use for: Data lists, specifications, requirements tables
- Format: First row is header with gray background and bold text
- All borders enabled (single line, black, 0.5pt)
- Example use: Device specifications, I2C address tables, requirements lists
- **Table Style Options**: Header Row enabled, First Column disabled

**DilonTable_Chart** (For data intersection tables):
- Use for: Matrix/cross-reference tables where both row and column represent categories
- Format: First row AND first column are headers with gray background and bold text
- All borders enabled (single line, black, 0.5pt)
- Example use: Pin mapping tables, register bit field tables, compatibility matrices
- **Table Style Options**: Header Row enabled, First Column enabled

**Creating Table Styles in Word:**

When creating custom table styles in the reference template:

1. Open `TEMPLATE_Word_Signature.docx`
2. Insert a sample table (3 columns × 3 rows)
3. Right-click table → "Table Styles" → "New Table Style..."
4. Name the style (e.g., "DilonTable_List" or "DilonTable_Chart")
5. Format the style:
   - Set all borders (top, bottom, left, right, inside horizontal, inside vertical)
   - Format header row: Gray background (#C0C0C0), bold text
   - For DilonTable_Chart: Also format first column with same styling
6. **CRITICAL**: Click "Modify" → At bottom left, check "Table Style Options":
   - For **DilonTable_List**: Check "Header Row", uncheck "First Column"
   - For **DilonTable_Chart**: Check both "Header Row" AND "First Column"
7. Click OK to save the style
8. Delete the sample table
9. Save the template

**Table Headers:**
- First row is always treated as header
- For DilonTable_Chart, first column is also treated as header
- Header cells have gray background (#C0C0C0) and bold text

**Selecting Table Style:**
- **All tables automatically receive styling**: The compiler applies `DilonTable_List` to every table by default
- To override and use **DilonTable_Chart** for a specific table, add a style marker immediately before the table:
- Tables without explicit style hints will automatically use `DilonTable_List`

**Syntax for custom table styles:**
```markdown
@@@TABLE_STYLE:DilonTable_Chart@@@
| Register | Address | Bit 7 | Bit 6 |
|----------|:-------:|:-----:|:-----:|
| CTRL_REG1 | 0x20 | ODR3 | ODR2 |
| CTRL_REG2 | 0x21 | BOOT | HPM1 |
```

**Rules:**
- Place the `@@@TABLE_STYLE:StyleName@@@` marker on its own line immediately before the table
- The marker paragraph must contain only the marker (can have leading/trailing whitespace)
- No blank lines between the marker and the table
- Available style names: `DilonTable_List` or `DilonTable_Chart`
- The marker paragraph will be automatically removed from the final Word document
- The compiler uses a state machine to:
  1. Find the `@@@TABLE_STYLE:StyleName@@@` marker
  2. Look for the first table immediately after the marker
  3. Apply the specified table style to that table only
  4. Automatically set Table Style Options (Header Row, First Column) based on the style type
  5. Remove the marker paragraph
- **Note**: If no table follows the marker, the marker is removed but no style is applied
- **Note**: Table Style Options are set programmatically, so you don't need to manually configure them in Word

**Multi-line Cells:**
- Pipe tables support single-line cells only
- **ISSUE**: `<br>` tags do NOT work in pipe table cells when converting to Word
- For multi-line content in table cells, you MUST use grid tables (see Section 14)
- Example that does NOT work:
  ```markdown
  | Field | Description |
  |-------|-------------|
  | Name  | First line<br>Second line |  <!-- <br> will not create line break -->
  ```

### 3.3 When NOT to Use Pipe Tables

If you need:
- **Multi-paragraph cells**
- **Nested lists within cells**
- **Complex block elements**

Use **grid tables** instead (see Advanced section below).

---

## 4. Figures and Images

### 4.1 Image Syntax

```markdown
![](path/to/image.png)
```

**IMPORTANT**: Use **empty brackets** `![]()` for images to avoid duplicate captions in Word output.

### 4.2 Figure with Caption

Place the caption on the line **immediately after** the image:

```markdown
![](diagrams/i2c_bus_topology.png)

*Figure 2.1: Complete I2C Bus Topology showing nRF52832 master connected to all peripheral devices.*


**Note**: Optional note or explanation can follow the caption after a blank line.
```

**Rules:**
- Image path is relative to the markdown file
- Use `![]()` with **empty brackets** - do NOT put alt text inside the brackets
- Alt text in brackets creates duplicate captions in Word
- Caption format: `*Figure N.M: Description.*` (italicized)
- **Two blank lines** after caption (one blank line, then another before next content)
- Caption should be concise but descriptive
- End caption with period

**Example:**
```markdown
![](diagrams/cpld_interface_architecture.png)

*Figure 2.2: CPLD Interface Architecture via PCA9534 GPIO extenders.*


### 2.3 Device Communication Protocol
```

### 4.3 PlantUML Diagrams

For architectural diagrams, use PlantUML:

1. Create `.puml` source file in `diagrams/` folder
2. Generate PNG: `plantuml -tpng diagram.puml`
3. Reference PNG in markdown:
   ```markdown
   ![](diagrams/diagram_name.png)

   *Figure X.Y: Diagram description.*
   ```

**PlantUML Best Practices:**
- Use `!theme plain` for clean output
- Set `skinparam backgroundColor white`
- Use `top to bottom direction` for vertical layouts
- Place diagrams in `diagrams/` subfolder
- Commit both `.puml` source and `.png` output

---

## 5. Lists

**IMPORTANT**: Always include a blank line before and after all lists (numbered and bulleted).

### 5.1 Unordered Lists

```markdown
This is a paragraph before the list.

- First item
- Second item
  - Nested item (2 spaces indent)
  - Another nested item
- Third item

This is a paragraph after the list.
```

### 5.2 Ordered Lists

```markdown
This is a paragraph before the list.

1. First step
2. Second step
   - Sub-point (use hyphen for nested bullets)
3. Third step

This is a paragraph after the list.
```

### 5.3 Definition Lists

For glossaries or field definitions:

```markdown
Paragraph before definition list.

**Term 1**
:   Definition of term 1

**Term 2**
:   Definition of term 2

Paragraph after definition list.
```

**Rules:**
- The colon (`:`) is a **parsing marker** for Pandoc to recognize definition structure
- The colon does NOT appear in the Word output - it's purely for markdown syntax
- Use **bold formatting** for terms to make them visually distinct
- Leave blank lines between definition entries
- Indent the definition text after the colon (3 spaces recommended)

**Example:**
```markdown
**I2C (Inter-Integrated Circuit)**
:   A two-wire serial communication protocol using SDA (data) and SCL (clock) lines.

**Master Device**
:   The device that initiates communication and generates clock signals on the I2C bus.

**Slave Device**
:   A device that responds to requests from the master device.
```

---

## 6. Code and Technical Content

### 6.1 Inline Code

Use **single backticks** for inline code (code within a paragraph):

```markdown
The `i2c_write()` function sends data to the device at address `0x50`.
```

**Word Styles Applied:**
- **Verbatim Char** (character style) - Applies to the text itself
- Font: Typically monospace (Consolas, Courier New)

**Correct:**
```markdown
Register `CTRL_REG1` has address `0x20`.
```

**Incorrect:**
```markdown
Register ```CTRL_REG1``` has address ```0x20```.
```
(Triple backticks are for code blocks, not inline code)

### 6.2 Code Blocks

Use **triple backticks** with optional language identifier for multi-line code blocks:

````markdown
```c
uint8_t data[8];
i2c_read(0x50, data, 8);
```
````

**Word Styles Applied:**
Pandoc applies TWO styles to code blocks:
1. **SourceCode** (paragraph style) - Controls block layout, indentation, background, spacing
2. **Verbatim Char** (character style) - Controls text font (monospace)

**Recommended SourceCode Style Settings:**
- **Font**: Consolas 9-10pt (overridden by Verbatim Char)
- **Background**: Light gray (RGB: 245, 245, 245)
- **Indentation**: Left 0.25" - 0.5"
- **Spacing**: 6pt before/after
- **Borders**: Optional - subtle gray border or left accent
- **Keep lines together**: Enabled

**Recommended Verbatim Char Style Settings:**
- **Font**: Consolas or Courier New 9-10pt
- **Color**: Black or dark gray
- **Style type**: Character (not Paragraph)

**Supported Language Identifiers:**
- `c` - C code
- `python` - Python code
- `bash` - Shell commands
- `vhdl` - VHDL code
- `javascript`, `java`, `go`, `rust` - Other languages
- Leave blank for plain text

**Note**: Language identifiers serve as documentation but do NOT affect Word formatting. All code blocks receive the same styling regardless of language.

**Example:**
````markdown
```c
void ee24aa02_read_buf(uint8_t address, uint8_t *buffer, size_t length) {
    i2c_write(0x50, &address, 1);
    i2c_read(0x50, buffer, length);
}
```
````

### 6.3 Register/Bit Field Notation

Use inline code for addresses, registers, bit fields:

```markdown
- Memory address `0x00-0x01` contains the CRC-16 checksum
- Register `CTRL_REG1` (address `0x20`) controls power mode
- Set bit `PD1:PD0` to `00` for normal operation
```

---

## 7. Emphasis and Formatting

### 7.1 Bold

Use double asterisks for **bold**:

```markdown
**Important**: This is critical information.
```

Use bold for:
- Important warnings
- Field names in descriptions
- Key terms on first mention

### 7.2 Italic

Use single asterisks for *italic*:

```markdown
*Figure captions are italicized.*
```

Use italic for:
- Figure captions
- Emphasis
- Document references

### 7.3 Bold + Italic

Use triple asterisks for ***bold italic***:

```markdown
***WARNING***: High voltage hazard.
```

---

## 8. Links and References

### 8.1 External Links

```markdown
[Link text](https://example.com)
```

### 8.2 Internal Cross-References

Reference sections by number using hyperlinks:

```markdown
See [Section 3.5](#grid-table-for-complex-content) for details on the MAX17263 fuel gauge.
```

**Rules:**
- Pandoc automatically generates identifiers for each heading
- Identifier format: lowercase, spaces replaced with hyphens, special characters removed
- Link syntax: `[Link text](#heading-identifier)`
- Example heading `### 3.5 Grid Table (For Complex Content)` → identifier `#grid-table-for-complex-content`
- Section numbers in headings are typically stripped from auto-generated identifiers
- For custom identifiers, use: `## My Heading {#custom-id}`

**Examples:**
```markdown
For table styling, see [Section 3.2](#table-formatting-in-word-output).

The definition list format is explained in [Section 4.3](#definition-lists).

Code examples can be found in [Section 6](#code-and-technical-content).
```

### 8.3 Code References

Reference specific files and line numbers:

```markdown
**Code Reference**: `task_supervisor.c:87-90`
```

Format: `filename:start_line-end_line` or `filename:line_number`

---

## 9. Notes and Callouts

### 9.1 Notes

```markdown
**Note**: This is an informational note.
```

### 9.2 Important/Warning

```markdown
**IMPORTANT**: Critical information that must be followed.

**WARNING**: Safety or regulatory warning.
```

### 9.3 Block Quotes

For longer notes or quoted text:

```markdown
> This is a block quote.
> It can span multiple lines.
```

---

## 10. Spacing and Line Breaks

### 10.1 Paragraph Spacing

- **One blank line** between paragraphs
- **Two blank lines** after figure captions
- **One blank line** after each heading (before starting content)
- **One blank line** before and after all lists (numbered and bulleted)
- **One blank line** before and after code blocks
- **One blank line** before and after tables

### 10.2 Section Breaks

Use horizontal rules sparingly (Pandoc will add page breaks):

```markdown
---
```

---

## 11. Special Pandoc Features

### 11.1 Math Equations (if needed)

Inline math: `$E = mc^2$`

Display math:
```markdown
$$
V_{out} = \frac{DAC_{code}}{4096} \times V_{REF}
$$
```

### 11.2 Footnotes

```markdown
Main text with a footnote.
[^1]

[^1]: This is the footnote content.
```

**IMPORTANT Rules:**
- The footnote reference `[^1]` must be on the **line immediately after** the text it references
- Use a single newline between the text and the footnote reference
- This placement ensures the "Footnote Reference" style is properly applied
- Footnote definitions `[^1]: content` can be placed anywhere (typically at end of section or document)
- Footnote numbering is automatic

**Correct:**
```markdown
This sentence needs a footnote.
[^1]

Another sentence with a footnote.
[^2]

[^1]: First footnote content.
[^2]: Second footnote content.
```

**Incorrect:**
```markdown
This sentence needs a footnote.[^1]
```
(Placing `[^1]` on the same line prevents proper style application)

---

## 12. Custom Paragraph Styles

For content that requires specific formatting beyond Pandoc's automatic styling, you can apply custom paragraph styles using `@@@STYLE@@@` markers.

### 12.1 Syntax

**IMPORTANT**: All custom paragraph styling requires both `@@@STYLE:StyleName@@@` START marker and `@@@END_STYLE@@@` END marker.

**Same Line (Single Paragraph):**
```markdown
@@@STYLE:SourceCode@@@ Content to be styled goes here. @@@END_STYLE@@@
```

**Multiple Lines:**
```markdown
@@@STYLE:SourceCode@@@
First paragraph content

Second paragraph content

Third paragraph content
@@@END_STYLE@@@
```

**Markers on Separate Lines:**
```markdown
@@@STYLE:SourceCode@@@

Content paragraph 1

Content paragraph 2

@@@END_STYLE@@@
```

### 12.2 How It Works

1. The compiler uses a **state machine** to scan the Word document after Pandoc conversion
2. When it finds `@@@STYLE:StyleName@@@` at the start of a paragraph, it enters "searching for end" state
3. When it finds `@@@END_STYLE@@@` at the end of a paragraph, it processes the block
4. **All paragraphs** between the markers (inclusive) receive the specified style
5. Markers are automatically removed from the final document
6. Empty paragraphs (containing only markers) are deleted
7. Leading/trailing whitespace is stripped after marker removal
8. The style name must exist in the reference template (`TEMPLATE_Word_Signature.docx`)

**Processing Steps:**
1. Find START marker (`@@@STYLE:StyleName@@@`)
2. Find matching END marker (`@@@END_STYLE@@@`)
3. Remove markers from all paragraphs in the block
4. Delete paragraphs that become empty after marker removal
5. Apply the specified style to all remaining paragraphs
6. Reset and continue searching for next block

### 12.3 Marker Rules

**START Marker (`@@@STYLE:StyleName@@@`):**
- Must be at the **beginning** of a paragraph (first non-whitespace text)
- Can be on its own line or on the same line as content
- Cannot be inside a code block (Verbatim Char style)
- Style name must contain only word characters (letters, numbers, underscore)

**END Marker (`@@@END_STYLE@@@`):**
- Must be at the **end** of a paragraph (last non-whitespace text)
- Can be on its own line or on the same line as content
- Cannot be inside a code block (Verbatim Char style)

**Edge Cases Handled:**
- ✅ Both markers on same line: `@@@STYLE:Name@@@ text @@@END_STYLE@@@`
- ✅ START marker alone in paragraph (paragraph will be deleted after processing)
- ✅ END marker alone in paragraph (paragraph will be deleted after processing)
- ✅ Multiple paragraphs between markers (0 to 100+ paragraphs)
- ✅ Markers in documentation examples (inside backticks) are preserved

### 12.4 Common Use Cases

**IMPORTANT**: Code blocks with triple backticks automatically receive styling from Pandoc. Use native markdown code blocks for actual code:

````markdown
```c
void setup() {
    pinMode(LED_BUILTIN, OUTPUT);
}
```
````

The custom `@@@STYLE@@@` system is for **non-code content** that needs special formatting:

**Hardware Configuration Instructions:**
```markdown
@@@STYLE:SourceCode@@@
HARDWARE CONFIGURATION: Connect GPIO pin 14 to LED anode through 330Ω resistor.
Connect LED cathode to GND. Verify forward voltage drop of 2.0V at 10mA.
@@@END_STYLE@@@
```

**Multi-Step Procedures:**
```markdown
@@@STYLE:SourceCode@@@
INITIALIZATION SEQUENCE:
Step 1: Apply power to VDD pin (3.3V ±5%)
Step 2: Wait 100ms for voltage stabilization
Step 3: Assert RESET pin LOW for minimum 10ms
Step 4: Release RESET pin and wait 50ms for boot sequence

VERIFICATION PROCEDURE:
Monitor STATUS register at address 0x00
Expected value: 0x42 (device ready)
If STATUS reads 0x00, repeat initialization sequence
@@@END_STYLE@@@
```

**Notes or Callouts (if custom NoteBox style exists):**
```markdown
@@@STYLE:NoteBox@@@
This is an important note that requires special formatting with custom background and borders.
@@@END_STYLE@@@
```

**Requirements (if custom Requirement style exists):**
```markdown
@@@STYLE:Requirement@@@
REQ-001: System SHALL initialize within 100ms of power-on
@@@END_STYLE@@@
```

### 12.5 Creating Custom Styles

To add a new custom style for use with `@@@STYLE@@@` markers:

1. Open `TEMPLATE_Word_Signature.docx`
2. Go to Home → Styles → Create a Style
3. Set **Style type** to "Paragraph" (not Character)
4. Name the style (e.g., "SourceCode", "NoteBox", "Requirement")
5. Format the style:
   - Font, size, color
   - Paragraph spacing (before/after)
   - Indentation
   - Background color/shading
   - Borders
   - Keep lines together (recommended for code-like content)
6. Save the template
7. Use the style name in markdown: `@@@STYLE:YourStyleName@@@`

**Note**: Style names are case-sensitive and must match exactly.

### 12.6 Documenting the Markers

To show the marker syntax in documentation (like this guide), place the markers inside inline code backticks:

```markdown
Use `@@@STYLE:StyleName@@@` to start styling and `@@@END_STYLE@@@` to end it.
```

The markers will be preserved in backticks and displayed to the user as documentation examples.

---

## 13. Document Structure Template

```markdown
---
title: "Your Document Title"
author: "Your Name"
department: "Engineering"
doc_number: "DD_NAV3_XXX_NNN"
current_revision: "1"
regulatory_rep: "Name"
quality_rep: "Name"
department_head: "Name"
revisions:
  - number: "1"
    description: "Initial release"
    eco_number: "--"
    eco_date: "--"
---

## 1. Purpose and Scope

### 1.1 Purpose

[Document purpose]

### 1.2 Scope

[Document scope]

## 2. Main Content Section

### 2.1 Subsection

Content goes here.

![Diagram](diagrams/example.png)

*Figure 2.1: Diagram description.*


| Column 1 | Column 2 |
|----------|----------|
| Data     | Data     |

## 3. References

### 3.1 Internal Documents

- Document Name: `path/to/document.md`

### 3.2 Datasheets

- Device Datasheet: Manufacturer Part Number
```

---

## 13. Conversion to Word

### 13.1 Using the Compiler

```bash
python generate_dilon_doc.py input.md output.docx
```

Or using PowerShell alias:
```powershell
Compile-DilonDoc input.md
```

### 13.2 What Happens During Conversion

1. **YAML front matter** is parsed and used to populate templates
2. **Markdown body** is converted to Word via Pandoc
3. **Tables** are styled with "Table Grid" style (grid lines included)
4. **Headings** are styled according to template (Heading 1, Heading 2, etc.)
5. **Code blocks** are styled with "Source Code" style
6. **Images** are embedded at original size
7. **Figure captions** are styled with "Caption" style
8. **All styles** come from `TEMPLATE_Word_Signature.docx` reference document

---

## 14. Advanced: Grid Tables (For Complex Content)

Use grid tables when you need multi-paragraph cells or complex block elements:

```markdown
+---------------+---------------+--------------------+
| Field         | Type          | Description        |
+===============+===============+====================+
| CRC-16        | 2 bytes       | Checksum for data  |
|               |               | integrity.         |
|               |               |                    |
|               |               | Calculated over    |
|               |               | addresses 0x02-0x15|
+---------------+---------------+--------------------+
| Board Rev     | 1 byte        | PCB revision       |
+---------------+---------------+--------------------+
```

**When to use:**
- Need multi-line text in cells
- Need nested lists or code blocks in cells
- Need precise control over cell content

**When NOT to use:**
- Simple tabular data (use pipe tables instead)
- Grid tables are harder to maintain in source

---

## 15. Checklist Before Generating Document

- [ ] YAML front matter complete and accurate
- [ ] All sections numbered consistently
- [ ] All figures have captions in format `*Figure N.M: Description.*`
- [ ] Two blank lines after each figure caption
- [ ] Tables use pipe format with proper alignment
- [ ] Code blocks have language identifiers
- [ ] File/line references use format `filename:line` or `filename:start-end`
- [ ] All PlantUML diagrams regenerated as PNG
- [ ] No trailing whitespace or tabs
- [ ] Document ends with newline
- [ ] All internal links reference correct section numbers

---

## 16. Common Mistakes to Avoid

❌ **Don't** use HTML in tables (use pipe tables or grid tables instead)
❌ **Don't** manually add grid lines or borders to markdown tables
❌ **Don't** use multiple spaces for alignment (use proper table syntax)
❌ **Don't** forget blank lines around code blocks and tables
❌ **Don't** use hard line breaks within paragraphs (let text flow naturally)
❌ **Don't** number sections in heading text if Pandoc auto-numbering is enabled
✅ **Do** use consistent heading levels
✅ **Do** include alt text for all images
✅ **Do** use code formatting for technical terms (registers, functions, etc.)
✅ **Do** preview the generated Word document to verify formatting

---

## 17. Style Reference

| Element | Markdown Syntax | Word Style Applied |
|---------|----------------|-------------------|
| Main heading | `## N. Title` | Heading 1 (paragraph) |
| Subsection | `### N.M Title` | Heading 2 (paragraph) |
| Sub-subsection | `#### N.M.P Title` | Heading 3 (paragraph) |
| Body text | Regular paragraph | Normal (paragraph) |
| Table (default) | Pipe table | DilonTable_List (table) |
| Table (custom) | `@@@TABLE_STYLE:DilonTable_Chart@@@` | DilonTable_Chart (table) |
| Figure caption | `*Figure N: ...*` | Caption (paragraph) |
| Code block | ` ```language ``` ` | SourceCode (paragraph) + Verbatim Char (character) |
| Custom paragraph style | `@@@STYLE:Name@@@ ... @@@END_STYLE@@@` | User-defined (paragraph) |
| Inline code | `` `code` `` | Verbatim Char (character) |
| Bold | `**text**` | Strong (character) |
| Italic | `*text*` | Emphasis (character) |
| Footnote reference | `[^1]` (on next line) | Footnote Reference (character) |
| Footnote text | `[^1]: content` | Footnote Text (paragraph) |
| Block quote | `> text` | Block Text or Quote (paragraph) |

---

## 18. Required Template Styles

Ensure these styles are properly defined in `TEMPLATE_Word_Signature.docx`:

### Paragraph Styles:
- **Heading 1, 2, 3** - Automatic from Word
- **Normal** - Automatic from Word
- **SourceCode** - Code block layout (background, indentation, spacing)
- **DilonTable_List** - Table style with header row only
- **DilonTable_Chart** - Table style with header row and column
- **Caption** - Figure/table captions (italic)
- **Footnote Text** - Footnote content at bottom of page
- **Block Text** or **Quote** - Block quotes (optional)

### Character Styles:
- **Verbatim Char** - Monospace font for code (inline and blocks)
- **Strong** - Bold text (automatic)
- **Emphasis** - Italic text (automatic)
- **Footnote Reference** - Superscript footnote numbers

**Note**: Pandoc requires these exact style names. Custom styles can be added but must match the `<!-- STYLE: -->` comment exactly.

---

**Version**: 2.0
**Last Updated**: 2025-10-10
**Maintained By**: Dilon Engineering Team
